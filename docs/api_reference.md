# DataWareHouse API ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

## æ¦‚è¦

DataWareHouseã¯ãƒ“ãƒ‡ã‚ªå‡¦ç†è©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ ã®ãŸã‚ã®åŒ…æ‹¬çš„ãªãƒ‡ãƒ¼ã‚¿ã‚¦ã‚§ã‚¢ãƒã‚¦ã‚¹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€åˆ©ç”¨å¯èƒ½ãªã™ã¹ã¦ã®APIé–¢æ•°ã«ã¤ã„ã¦è©³ã—ãèª¬æ˜ã—ã¾ã™ã€‚

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
pip install datawarehouse
```

## åŸºæœ¬çš„ãªä½¿ç”¨æ–¹æ³•

```python
import datawarehouse as dwh

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š
with dwh.DWHConnection('my_database.db') as conn:
    # APIé–¢æ•°ã®ä½¿ç”¨
    pass
```

## API é–¢æ•°ä¸€è¦§

### æ¥ç¶šç®¡ç†

#### `DWHConnection(db_path: str)`

DataWareHouseãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®æ¥ç¶šã‚’ç®¡ç†ã™ã‚‹ã‚¯ãƒ©ã‚¹ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `db_path` (str): ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹

**ä½¿ç”¨ä¾‹:**
```python
conn = dwh.DWHConnection('database.db')
# ã¾ãŸã¯
with dwh.DWHConnection('database.db') as conn:
    pass
```

#### `get_connection(db_path: str = "database.db") -> DWHConnection`

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚’å–å¾—ã™ã‚‹é–¢æ•°ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `db_path` (str, optional): ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯"database.db"

**æˆ»ã‚Šå€¤:**
- `DWHConnection`: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ

### ã‚¿ã‚¹ã‚¯ç®¡ç†

#### `create_task(task_set: int, task_name: str, task_describe: str) -> int`

æ–°ã—ã„ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `task_set` (int): ã‚¿ã‚¹ã‚¯ã®ã‚»ãƒƒãƒˆç•ªå·
- `task_name` (str): ã‚¿ã‚¹ã‚¯å
- `task_describe` (str): ã‚¿ã‚¹ã‚¯ã®èª¬æ˜

**æˆ»ã‚Šå€¤:**
- `int`: ä½œæˆã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã®ID

#### `get_task(task_id: int) -> dict`

æŒ‡å®šã•ã‚ŒãŸIDã®ã‚¿ã‚¹ã‚¯ã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `task_id` (int): ã‚¿ã‚¹ã‚¯ID

**æˆ»ã‚Šå€¤:**
- `dict`: ã‚¿ã‚¹ã‚¯æƒ…å ±

#### `list_tasks() -> list`

ã™ã¹ã¦ã®ã‚¿ã‚¹ã‚¯ã‚’å–å¾—ã—ã¾ã™ã€‚

**æˆ»ã‚Šå€¤:**
- `list`: ã‚¿ã‚¹ã‚¯æƒ…å ±ã®ãƒªã‚¹ãƒˆ

#### `update_task(task_id: int, **kwargs) -> bool`

ã‚¿ã‚¹ã‚¯æƒ…å ±ã‚’æ›´æ–°ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `task_id` (int): æ›´æ–°ã™ã‚‹ã‚¿ã‚¹ã‚¯ID
- `**kwargs`: æ›´æ–°ã™ã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆtask_name, task_describeãªã©ï¼‰

**æˆ»ã‚Šå€¤:**
- `bool`: æ›´æ–°æˆåŠŸã®å ´åˆTrue

#### `delete_task(task_id: int) -> bool`

ã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `task_id` (int): å‰Šé™¤ã™ã‚‹ã‚¿ã‚¹ã‚¯ID

**æˆ»ã‚Šå€¤:**
- `bool`: å‰Šé™¤æˆåŠŸã®å ´åˆTrue

### è¢«é¨“è€…ç®¡ç†

#### `create_subject(subject_name: str) -> int`

æ–°ã—ã„è¢«é¨“è€…ã‚’ä½œæˆã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `subject_name` (str): è¢«é¨“è€…å

**æˆ»ã‚Šå€¤:**
- `int`: ä½œæˆã•ã‚ŒãŸè¢«é¨“è€…ã®ID

#### `get_subject(subject_id: int) -> dict`

æŒ‡å®šã•ã‚ŒãŸIDã®è¢«é¨“è€…ã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `subject_id` (int): è¢«é¨“è€…ID

**æˆ»ã‚Šå€¤:**
- `dict`: è¢«é¨“è€…æƒ…å ±

#### `list_subjects() -> list`

ã™ã¹ã¦ã®è¢«é¨“è€…ã‚’å–å¾—ã—ã¾ã™ã€‚

**æˆ»ã‚Šå€¤:**
- `list`: è¢«é¨“è€…æƒ…å ±ã®ãƒªã‚¹ãƒˆ

#### `update_subject(subject_id: int, subject_name: str) -> bool`

è¢«é¨“è€…æƒ…å ±ã‚’æ›´æ–°ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `subject_id` (int): æ›´æ–°ã™ã‚‹è¢«é¨“è€…ID
- `subject_name` (str): æ–°ã—ã„è¢«é¨“è€…å

**æˆ»ã‚Šå€¤:**
- `bool`: æ›´æ–°æˆåŠŸã®å ´åˆTrue

#### `delete_subject(subject_id: int) -> bool`

è¢«é¨“è€…ã‚’å‰Šé™¤ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `subject_id` (int): å‰Šé™¤ã™ã‚‹è¢«é¨“è€…ID

**æˆ»ã‚Šå€¤:**
- `bool`: å‰Šé™¤æˆåŠŸã®å ´åˆTrue

#### `find_subject_by_name(subject_name: str) -> dict`

åå‰ã§è¢«é¨“è€…ã‚’æ¤œç´¢ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `subject_name` (str): æ¤œç´¢ã™ã‚‹è¢«é¨“è€…å

**æˆ»ã‚Šå€¤:**
- `dict`: è¢«é¨“è€…æƒ…å ±ã€è¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯None

### ãƒ“ãƒ‡ã‚ªç®¡ç†

#### `create_video(video_dir: str, subject_id: int, video_date: str, video_length: int) -> int`

æ–°ã—ã„ãƒ“ãƒ‡ã‚ªã‚’ä½œæˆã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `video_dir` (str): ãƒ“ãƒ‡ã‚ªãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ‘ã‚¹
- `subject_id` (int): è¢«é¨“è€…ID
- `video_date` (str): æ’®å½±æ—¥ï¼ˆYYYY-MM-DDå½¢å¼ï¼‰
- `video_length` (int): ãƒ“ãƒ‡ã‚ªã®é•·ã•ï¼ˆç§’ï¼‰

**æˆ»ã‚Šå€¤:**
- `int`: ä½œæˆã•ã‚ŒãŸãƒ“ãƒ‡ã‚ªã®ID

#### `get_video(video_id: int) -> dict`

æŒ‡å®šã•ã‚ŒãŸIDã®ãƒ“ãƒ‡ã‚ªã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `video_id` (int): ãƒ“ãƒ‡ã‚ªID

**æˆ»ã‚Šå€¤:**
- `dict`: ãƒ“ãƒ‡ã‚ªæƒ…å ±

#### `list_videos() -> list`

ã™ã¹ã¦ã®ãƒ“ãƒ‡ã‚ªã‚’å–å¾—ã—ã¾ã™ã€‚

**æˆ»ã‚Šå€¤:**
- `list`: ãƒ“ãƒ‡ã‚ªæƒ…å ±ã®ãƒªã‚¹ãƒˆ

#### `get_videos_by_subject(subject_id: int) -> list`

æŒ‡å®šã•ã‚ŒãŸè¢«é¨“è€…ã®ã™ã¹ã¦ã®ãƒ“ãƒ‡ã‚ªã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `subject_id` (int): è¢«é¨“è€…ID

**æˆ»ã‚Šå€¤:**
- `list`: ãƒ“ãƒ‡ã‚ªæƒ…å ±ã®ãƒªã‚¹ãƒˆ

#### `update_video(video_id: int, **kwargs) -> bool`

ãƒ“ãƒ‡ã‚ªæƒ…å ±ã‚’æ›´æ–°ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `video_id` (int): æ›´æ–°ã™ã‚‹ãƒ“ãƒ‡ã‚ªID
- `**kwargs`: æ›´æ–°ã™ã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰

**æˆ»ã‚Šå€¤:**
- `bool`: æ›´æ–°æˆåŠŸã®å ´åˆTrue

#### `delete_video(video_id: int) -> bool`

ãƒ“ãƒ‡ã‚ªã‚’å‰Šé™¤ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `video_id` (int): å‰Šé™¤ã™ã‚‹ãƒ“ãƒ‡ã‚ªID

**æˆ»ã‚Šå€¤:**
- `bool`: å‰Šé™¤æˆåŠŸã®å ´åˆTrue

### ã‚¿ã‚°ç®¡ç†

#### `create_tag(video_id: int, task_id: int, start: int, end: int) -> int`

æ–°ã—ã„ã‚¿ã‚°ã‚’ä½œæˆã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `video_id` (int): ãƒ“ãƒ‡ã‚ªID
- `task_id` (int): ã‚¿ã‚¹ã‚¯ID
- `start` (int): ã‚¿ã‚¹ã‚¯é–‹å§‹ãƒ•ãƒ¬ãƒ¼ãƒ 
- `end` (int): ã‚¿ã‚¹ã‚¯çµ‚äº†ãƒ•ãƒ¬ãƒ¼ãƒ 

**æˆ»ã‚Šå€¤:**
- `int`: ä½œæˆã•ã‚ŒãŸã‚¿ã‚°ã®ID

#### `get_tag(tag_id: int) -> dict`

æŒ‡å®šã•ã‚ŒãŸIDã®ã‚¿ã‚°ã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `tag_id` (int): ã‚¿ã‚°ID

**æˆ»ã‚Šå€¤:**
- `dict`: ã‚¿ã‚°æƒ…å ±

#### `get_video_tags(video_id: int) -> list`

æŒ‡å®šã•ã‚ŒãŸãƒ“ãƒ‡ã‚ªã®ã™ã¹ã¦ã®ã‚¿ã‚°ã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `video_id` (int): ãƒ“ãƒ‡ã‚ªID

**æˆ»ã‚Šå€¤:**
- `list`: ã‚¿ã‚°æƒ…å ±ã®ãƒªã‚¹ãƒˆ

#### `get_task_tags(task_id: int) -> list`

æŒ‡å®šã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã®ã™ã¹ã¦ã®ã‚¿ã‚°ã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `task_id` (int): ã‚¿ã‚¹ã‚¯ID

**æˆ»ã‚Šå€¤:**
- `list`: ã‚¿ã‚°æƒ…å ±ã®ãƒªã‚¹ãƒˆ

#### `list_tags() -> list`

ã™ã¹ã¦ã®ã‚¿ã‚°ã‚’å–å¾—ã—ã¾ã™ã€‚

**æˆ»ã‚Šå€¤:**
- `list`: ã‚¿ã‚°æƒ…å ±ã®ãƒªã‚¹ãƒˆ

#### `update_tag(tag_id: int, **kwargs) -> bool`

ã‚¿ã‚°æƒ…å ±ã‚’æ›´æ–°ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `tag_id` (int): æ›´æ–°ã™ã‚‹ã‚¿ã‚°ID
- `**kwargs`: æ›´æ–°ã™ã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰

**æˆ»ã‚Šå€¤:**
- `bool`: æ›´æ–°æˆåŠŸã®å ´åˆTrue

#### `delete_tag(tag_id: int) -> bool`

ã‚¿ã‚°ã‚’å‰Šé™¤ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `tag_id` (int): å‰Šé™¤ã™ã‚‹ã‚¿ã‚°ID

**æˆ»ã‚Šå€¤:**
- `bool`: å‰Šé™¤æˆåŠŸã®å ´åˆTrue

#### `get_tag_duration(tag_id: int) -> int`

ã‚¿ã‚°ã®ç¶™ç¶šæ™‚é–“ã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `tag_id` (int): ã‚¿ã‚°ID

**æˆ»ã‚Šå€¤:**
- `int`: ç¶™ç¶šæ™‚é–“ï¼ˆãƒ•ãƒ¬ãƒ¼ãƒ æ•°ï¼‰

### ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç®¡ç†

#### `create_core_lib_version(version: str, update_info: str, commit_hash: str, base_version_id: int = None) -> int`

æ–°ã—ã„ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `version` (str): ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·
- `update_info` (str): æ›´æ–°æƒ…å ±
- `commit_hash` (str): ã‚³ãƒŸãƒƒãƒˆãƒãƒƒã‚·ãƒ¥
- `base_version_id` (int, optional): ãƒ™ãƒ¼ã‚¹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ID

**æˆ»ã‚Šå€¤:**
- `int`: ä½œæˆã•ã‚ŒãŸã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ID

#### `get_core_lib_version(core_lib_id: int) -> dict`

æŒ‡å®šã•ã‚ŒãŸIDã®ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `core_lib_id` (int): ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³ID

**æˆ»ã‚Šå€¤:**
- `dict`: ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±

#### `list_core_lib_versions() -> list`

ã™ã¹ã¦ã®ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—ã—ã¾ã™ã€‚

**æˆ»ã‚Šå€¤:**
- `list`: ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã®ãƒªã‚¹ãƒˆ

#### `get_core_lib_version_history(core_lib_id: int) -> list`

æŒ‡å®šã•ã‚ŒãŸã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®å±¥æ­´ã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `core_lib_id` (int): ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³ID

**æˆ»ã‚Šå€¤:**
- `list`: ãƒãƒ¼ã‚¸ãƒ§ãƒ³å±¥æ­´ã®ãƒªã‚¹ãƒˆ

#### `find_core_lib_by_version(version: str) -> dict`

ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·ã§ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æ¤œç´¢ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `version` (str): ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·

**æˆ»ã‚Šå€¤:**
- `dict`: ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±

#### `find_core_lib_by_commit_hash(commit_hash: str) -> dict`

ã‚³ãƒŸãƒƒãƒˆãƒãƒƒã‚·ãƒ¥ã§ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æ¤œç´¢ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `commit_hash` (str): ã‚³ãƒŸãƒƒãƒˆãƒãƒƒã‚·ãƒ¥

**æˆ»ã‚Šå€¤:**
- `dict`: ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±

### ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå‡ºåŠ›ç®¡ç†

#### `create_core_lib_output(core_lib_id: int, video_id: int, output_dir: str) -> int`

æ–°ã—ã„ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå‡ºåŠ›ã‚’ä½œæˆã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `core_lib_id` (int): ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³ID
- `video_id` (int): ãƒ“ãƒ‡ã‚ªID
- `output_dir` (str): å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

**æˆ»ã‚Šå€¤:**
- `int`: ä½œæˆã•ã‚ŒãŸã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå‡ºåŠ›ã®ID

#### `get_core_lib_output(core_lib_output_id: int) -> dict`

æŒ‡å®šã•ã‚ŒãŸIDã®ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå‡ºåŠ›ã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `core_lib_output_id` (int): ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå‡ºåŠ›ID

**æˆ»ã‚Šå€¤:**
- `dict`: ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå‡ºåŠ›æƒ…å ±

#### `list_core_lib_outputs() -> list`

ã™ã¹ã¦ã®ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå‡ºåŠ›ã‚’å–å¾—ã—ã¾ã™ã€‚

**æˆ»ã‚Šå€¤:**
- `list`: ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå‡ºåŠ›æƒ…å ±ã®ãƒªã‚¹ãƒˆ

### ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ç®¡ç†

#### `create_algorithm_version(version: str, update_info: str, commit_hash: str, base_version_id: int = None) -> int`

æ–°ã—ã„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `version` (str): ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·
- `update_info` (str): æ›´æ–°æƒ…å ±
- `commit_hash` (str): ã‚³ãƒŸãƒƒãƒˆãƒãƒƒã‚·ãƒ¥
- `base_version_id` (int, optional): ãƒ™ãƒ¼ã‚¹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ID

**æˆ»ã‚Šå€¤:**
- `int`: ä½œæˆã•ã‚ŒãŸã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ID

#### `get_algorithm_version(algorithm_id: int) -> dict`

æŒ‡å®šã•ã‚ŒãŸIDã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `algorithm_id` (int): ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ID

**æˆ»ã‚Šå€¤:**
- `dict`: ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±

#### `list_algorithm_versions() -> list`

ã™ã¹ã¦ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—ã—ã¾ã™ã€‚

**æˆ»ã‚Šå€¤:**
- `list`: ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã®ãƒªã‚¹ãƒˆ

#### `get_algorithm_version_history(algorithm_id: int) -> list`

æŒ‡å®šã•ã‚ŒãŸã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®å±¥æ­´ã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `algorithm_id` (int): ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ID

**æˆ»ã‚Šå€¤:**
- `list`: ãƒãƒ¼ã‚¸ãƒ§ãƒ³å±¥æ­´ã®ãƒªã‚¹ãƒˆ

#### `find_algorithm_by_version(version: str) -> dict`

ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·ã§ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’æ¤œç´¢ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `version` (str): ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·

**æˆ»ã‚Šå€¤:**
- `dict`: ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±

#### `find_algorithm_by_commit_hash(commit_hash: str) -> dict`

ã‚³ãƒŸãƒƒãƒˆãƒãƒƒã‚·ãƒ¥ã§ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’æ¤œç´¢ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `commit_hash` (str): ã‚³ãƒŸãƒƒãƒˆãƒãƒƒã‚·ãƒ¥

**æˆ»ã‚Šå€¤:**
- `dict`: ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±

#### `get_latest_algorithm_version() -> dict`

æœ€æ–°ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—ã—ã¾ã™ã€‚

**æˆ»ã‚Šå€¤:**
- `dict`: æœ€æ–°ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±

### ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å‡ºåŠ›ç®¡ç†

#### `create_algorithm_output(algorithm_id: int, core_lib_output_id: int, output_dir: str) -> int`

æ–°ã—ã„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å‡ºåŠ›ã‚’ä½œæˆã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `algorithm_id` (int): ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ID
- `core_lib_output_id` (int): ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå‡ºåŠ›ID
- `output_dir` (str): å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

**æˆ»ã‚Šå€¤:**
- `int`: ä½œæˆã•ã‚ŒãŸã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å‡ºåŠ›ã®ID

#### `get_algorithm_output(algorithm_output_id: int) -> dict`

æŒ‡å®šã•ã‚ŒãŸIDã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å‡ºåŠ›ã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `algorithm_output_id` (int): ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å‡ºåŠ›ID

**æˆ»ã‚Šå€¤:**
- `dict`: ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å‡ºåŠ›æƒ…å ±

#### `list_algorithm_outputs() -> list`

ã™ã¹ã¦ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å‡ºåŠ›ã‚’å–å¾—ã—ã¾ã™ã€‚

**æˆ»ã‚Šå€¤:**
- `list`: ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å‡ºåŠ›æƒ…å ±ã®ãƒªã‚¹ãƒˆ

## ä¾‹å¤–ã‚¯ãƒ©ã‚¹

### `DWHError`

DataWareHouseé–¢é€£ã®åŸºæœ¬ä¾‹å¤–ã‚¯ãƒ©ã‚¹ã€‚

### `DWHConnectionError`

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼ã€‚

### `DWHNotFoundError`

ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚‰ãªã„ã‚¨ãƒ©ãƒ¼ã€‚

### `DWHValidationError`

ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ã‚¨ãƒ©ãƒ¼ã€‚

### `DWHConstraintError`

åˆ¶ç´„é•åã‚¨ãƒ©ãƒ¼ã€‚

### `DWHUniqueConstraintError`

UNIQUEåˆ¶ç´„é•åã‚¨ãƒ©ãƒ¼ã€‚

## CLI ãƒ„ãƒ¼ãƒ«

### `dwh-cli create-db <db_path>`

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆãƒ»åˆæœŸåŒ–ã—ã¾ã™ã€‚

### `dwh-cli info <db_path>`

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹é€ æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

### `dwh-cli --help`

ãƒ˜ãƒ«ãƒ—ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

## ã‚¹ã‚­ãƒ¼ãƒæ¤œè¨¼

### `validate_database_schema(db_path: str) -> Dict`

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã‚’æ¤œè¨¼ã—ã€è©³ç´°ãªæ¤œè¨¼çµæœã‚’è¿”ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `db_path` (str): ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹

**æˆ»ã‚Šå€¤:**
- `Dict`: æ¤œè¨¼çµæœ
  ```python
  {
      'is_valid': bool,           # ã‚¹ã‚­ãƒ¼ãƒãŒæœ‰åŠ¹ã‹ã©ã†ã‹
      'issues': List[Dict],       # é‡å¤§ãªå•é¡Œã®ãƒªã‚¹ãƒˆ
      'warnings': List[Dict],     # è­¦å‘Šã®ãƒªã‚¹ãƒˆ
      'tables_found': List[str],  # æ¤œå‡ºã•ã‚ŒãŸãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒªã‚¹ãƒˆ
      'tables_missing': List[str], # æ¬ è½ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒªã‚¹ãƒˆ
      'indexes_found': List[str], # æ¤œå‡ºã•ã‚ŒãŸã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ãƒªã‚¹ãƒˆ
      'indexes_missing': List[str], # æ¬ è½ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ãƒªã‚¹ãƒˆ
      'summary': Dict             # ã‚µãƒãƒªãƒ¼æƒ…å ±
  }
  ```

**ä½¿ç”¨ä¾‹:**
```python
result = validate_database_schema('database.db')
if result['is_valid']:
    print("ã‚¹ã‚­ãƒ¼ãƒã¯æœ‰åŠ¹ã§ã™")
else:
    print(f"å•é¡ŒãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ: {len(result['issues'])}ä»¶")
```

### `get_schema_validation_report(db_path: str) -> str`

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒæ¤œè¨¼ã®è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆã‚’æ–‡å­—åˆ—å½¢å¼ã§è¿”ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `db_path` (str): ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹

**æˆ»ã‚Šå€¤:**
- `str`: äººé–“å¯èª­ãªæ¤œè¨¼ãƒ¬ãƒãƒ¼ãƒˆ

**ä½¿ç”¨ä¾‹:**
```python
report = get_schema_validation_report('database.db')
print(report)
```

### `check_database_compatibility(db_path: str) -> bool`

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒDataWareHouseã¨äº’æ›æ€§ãŒã‚ã‚‹ã‹ã‚’ç°¡æ˜“çš„ã«ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `db_path` (str): ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹

**æˆ»ã‚Šå€¤:**
- `bool`: äº’æ›æ€§ãŒã‚ã‚‹å ´åˆTrue

**ä½¿ç”¨ä¾‹:**
```python
is_compatible = check_database_compatibility('database.db')
if is_compatible:
    print("ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¯äº’æ›æ€§ãŒã‚ã‚Šã¾ã™")
else:
    print("ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«äº’æ›æ€§ã®å•é¡ŒãŒã‚ã‚Šã¾ã™")
```

### `SchemaValidator`

ã‚¹ã‚­ãƒ¼ãƒæ¤œè¨¼ã‚’è¡Œã†ã‚¯ãƒ©ã‚¹ã§ã™ã€‚ä¸Šè¨˜ã®é–¢æ•°ã¯ã“ã®ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚

**ãƒ¡ã‚½ãƒƒãƒ‰:**
- `validate_schema() -> Dict`: ã‚¹ã‚­ãƒ¼ãƒæ¤œè¨¼ã‚’å®Ÿè¡Œ
- `get_validation_report(validation_result: Dict) -> str`: æ¤œè¨¼çµæœã‹ã‚‰ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆ

**ä½¿ç”¨ä¾‹:**
```python
from datawarehouse import SchemaValidator

validator = SchemaValidator('database.db')
result = validator.validate_schema()
report = validator.get_validation_report(result)
```

## CLI ãƒ„ãƒ¼ãƒ«

### `dwh-cli validate <db_path>`

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã‚’æ¤œè¨¼ã—ã€è©³ç´°ãªãƒ¬ãƒãƒ¼ãƒˆã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

**å¼•æ•°:**
- `db_path`: æ¤œè¨¼ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹

**ä½¿ç”¨ä¾‹:**
```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒæ¤œè¨¼
dwh-cli validate database.db

# æ¤œè¨¼çµæœã®ä¾‹
============================================================
DataWareHouse ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒæ¤œè¨¼ãƒ¬ãƒãƒ¼ãƒˆ
============================================================
ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹: database.db

ã‚µãƒãƒªãƒ¼:
  æƒ³å®šãƒ†ãƒ¼ãƒ–ãƒ«æ•°: 13
  æ¤œå‡ºãƒ†ãƒ¼ãƒ–ãƒ«æ•°: 13
  æ¬ è½ãƒ†ãƒ¼ãƒ–ãƒ«æ•°: 0
  æ¤œå‡ºã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ•°: 2
  æ¬ è½ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ•°: 0
  é‡å¤§å•é¡Œæ•°: 0
  è­¦å‘Šæ•°: 0

âœ… æ¤œè¨¼çµæœ: æœ‰åŠ¹ãªDataWareHouseã‚¹ã‚­ãƒ¼ãƒã§ã™

ğŸ“‹ æ¤œå‡ºã•ã‚ŒãŸãƒ†ãƒ¼ãƒ–ãƒ«:
  â€¢ algorithm_output_table
  â€¢ algorithm_table
  â€¢ analysis_data_table
  â€¢ analysis_result_table
  â€¢ core_lib_output_table
  â€¢ core_lib_table
  â€¢ evaluation_data_table
  â€¢ evaluation_result_table
  â€¢ problem_table
  â€¢ subject_table
  â€¢ tag_table
  â€¢ task_table
  â€¢ video_table

ğŸ” æ¤œå‡ºã•ã‚ŒãŸã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹:
  â€¢ idx_algorithm_version
  â€¢ idx_core_lib_version
============================================================
âœ… ã“ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¯DataWareHouseã¨äº’æ›æ€§ãŒã‚ã‚Šã¾ã™
```

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License
